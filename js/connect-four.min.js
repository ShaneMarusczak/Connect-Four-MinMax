(()=>{function w(a){if(!n&&!q){a=Number(a.target.id.substring(3));document.getElementById("fc"+a).classList.add("bounce");for(let b=5;0<=b;b--)if(document.getElementById("td"+b+a).classList.contains("empty")){document.getElementById("td"+b+a).classList.add("glow");break}}}function x(a){a=Number(a.target.id.substring(3));document.getElementById("fc"+a).classList.remove("bounce");for(let b=5;0<=b;b--)if(document.getElementById("td"+b+a).classList.contains("empty")){document.getElementById("td"+b+a).classList.remove("glow");
break}}function m(a){return new Promise(b=>setTimeout(b,a))}function r(a,b){const c=document.createElement("div");c.id="modal-box";const h=document.createElement("div");h.id="inner-modal-box";const e=document.createElement("span");e.id="modal-message";h.appendChild(e);c.appendChild(h);e.innerText=a;document.getElementsByTagName("html")[0].appendChild(c);m(b).then(()=>c.remove())}let l=[3,2,4,1,5,6,0],n=!1,t=!1,q=!1;class u{constructor(a,b,c){this.g=a;this.i=b;this.j=c}G(a,b){return 0===a||b===this.g.h||
b===-this.g.h||this.u()}F(a){for(let b=this.g.rows-1;0<=b;b--)if(null===this.i[b][a])return!1;return!0}H(a,b){for(let c=this.g.rows-1;0<=c;c--)if(null===this.i[c][a]){this.i[c][a]=b;break}}A(a){if(null===this.i[0][a]&&0<=a&&a<this.g.o){for(let b=this.g.rows-1;0<=b;b--)if(null===this.i[b][a]){this.i[b][a]=this.j;break}this.j=0===this.j?1:0;return!0}return!1}l(a,b,c,h,e){let d=0,f=0;e&&(this.g.J=[],this.g.I=[]);for(let k=0;4>k;k++)0===this.i[a][b]?(e&&this.g.J.push([a,b]),d++):1===this.i[a][b]&&(e&&
this.g.I.push([a,b]),f++),a+=c,b+=h;return 4===d?(e&&(this.g.m=this.g.J),-this.g.h):4===f?(e&&(this.g.m=this.g.I),this.g.h):f}s(a){let b=0,c=0,h=0,e=0;for(var d=0;d<this.g.rows-3;d++)for(var f=0;f<this.g.o;f++){var k=this.l(d,f,1,0,a);if(k===this.g.h)return this.g.h;if(k===-this.g.h)return-this.g.h;b+=k}for(d=0;d<this.g.rows;d++)for(f=0;f<this.g.o-3;f++){k=this.l(d,f,0,1,a);if(k===this.g.h)return this.g.h;if(k===-this.g.h)return-this.g.h;c+=k}for(d=0;d<this.g.rows-3;d++)for(f=0;f<this.g.o-3;f++){k=
this.l(d,f,1,1,a);if(k===this.g.h)return this.g.h;if(k===-this.g.h)return-this.g.h;h+=k}for(d=3;d<this.g.rows;d++)for(f=0;f<=this.g.o-4;f++){k=this.l(d,f,-1,1,a);if(k===this.g.h)return this.g.h;if(k===-this.g.h)return-this.g.h;e+=k}return c+b+h+e}u(){for(let a=0;a<this.g.o;a++)if(null===this.i[0][a])return!1;return!0}v(){const a=[];for(let b=0;b<this.i.length;b++)a.push(this.i[b].slice());return new u(this.g,a,this.j)}}class p{constructor(a){this.rows=6;this.o=7;this.P=a;this.h=1E5;this.round=0;this.m=
[];this.u=0;this.g=void 0;this.K()}K(){const a=Array(6);for(let b=0;b<a.length;b++){a[b]=Array(7);for(let c=0;c<a[b].length;c++)a[b][c]=null}this.g=new u(this,a,0);Array.from(document.getElementById("gameBoard").getElementsByTagName("td")).forEach(b=>{b.addEventListener("click",c=>{this.R(c)},!1);b.addEventListener("mouseover",w);b.addEventListener("mouseleave",x)})}R(a){n||(this.u++,document.getElementById("uiBlocker").classList.add("block"),a=a.target,0===this.round&&this.l(a.cellIndex),document.getElementById("fc"+
a.cellIndex).classList.remove("bounce"),m(600).then(()=>{1===this.round&&this.U()}))}static g({C:a,B:b,D:c,O:h=0}={}){h===a?(n||c||(m(10).then(()=>{const e=document.createElement("div");e.id="modal-box";const d=document.createElement("div");d.id="inner-modal-box";var f=document.createElement("span");f.id="modal-message";d.appendChild(f);e.appendChild(d);f.innerText="Thinking...";f=document.createElement("div");f.classList.add("animation");for(let k=0;3>k;k++)f.appendChild(document.createElement("div"));
d.appendChild(f);document.getElementsByTagName("html")[0].appendChild(e)}),document.getElementsByTagName("html")[0].classList.add("progressCursor"),v("yellow")),c&&(document.getElementById("uiBlocker").classList.remove("block"),v("red"),q=!1),document.getElementById("td"+h+b).className=c?"coin cpu-coin":"coin human-coin"):(q=!0,document.getElementById("td"+h+b).classList.add("coin"),document.getElementById("td"+h+b).classList.add(c?"cpu-coin":"human-coin"),m(85).then(()=>{document.getElementById("td"+
h+b).classList.remove("coin");document.getElementById("td"+h+b).classList.remove(c?"cpu-coin":"human-coin")}),m(85).then(()=>{p.g({O:h+1,B:b,C:a,D:c})}))}l(a){if(!n){for(let b=this.rows-1;0<=b;b--)if(document.getElementById("gameBoard").rows[b].cells[a].classList.contains("empty")){1===this.round?p.g({B:a,C:b,D:!0}):p.g({B:a,C:b,D:!1});break}this.g.A(a)?(this.round=0===this.round?1:0,this.S()):(document.getElementById("uiBlocker").classList.remove("block"),r("Invalid move!",1500))}}M(){for(var a=
0;7>a;a++){var b=this.g.v();if(!b.F(a)&&(b.H(a,1),1E5===b.s(!1)))return a}for(a=0;7>a;a++)if(b=this.g.v(),!b.F(a)&&(b.H(a,0),-1E5===b.s(!1)))return a;return-1}T(){let a;for(let b=2;b<=this.P;b++){let [c]=this.j(this.g,b,-1E5,1E5);a=c;0===c?l=[0,1,2,3,4,5,6]:1===c?l=[1,0,2,3,4,5,6]:2===c?l=[2,1,3,0,4,5,6]:3===c?l=[3,2,4,1,5,0,6]:4===c?l=[4,3,5,2,6,1,0]:5===c?l=[5,6,4,3,2,1,0]:6===c&&(l=[6,5,4,3,2,1,0])}return a}U(){if(!n){let a=0;const b=this.M();1===this.u?a=3:a=-1!==b?b:this.T();m(150).then(()=>
{document.getElementById("modal-box").remove();m(50).then(()=>this.l(a))})}}j(a,b,c,h){var e=a.s(!1);if(a.G(b,e))return[-1,e];e=[-1,-99999];for(let f of l){var d=a.v();if(d.A(f)){d=this.L(d,b-1,c,h);if(-1===e[0]||d[1]>e[1])e[0]=f,[,e[1]]=d,[,c]=d;if(c>=h)break}}return e}L(a,b,c,h){var e=a.s(!1);if(a.G(b,e))return[-1,e];e=[-1,99999];for(let f of l){var d=a.v();if(d.A(f)){d=this.j(d,b-1,c,h);if(-1===e[0]||d[1]<e[1])e[0]=f,[,e[1]]=d,[,h]=d;if(c>=h)break}}return e}S(){const a=this.g.s(!0);-1E5===a?this.i("You Win!"):
1E5===a?this.i("You Lose!"):this.g.u()&&(n=!0,r("Draw!",2E3));document.getElementsByTagName("html")[0].classList.remove("progressCursor")}i(a){document.getElementById("uiBlocker").classList.remove("block");n=!0;r(a,2E3);m(1E3).then(()=>{this.N()})}N(){document.getElementById("gameBoard").className="finished";for(let a=0;a<this.m.length;a++)document.getElementById("gameBoard").rows[this.m[a][0]].cells[this.m[a][1]].className=document.getElementById("gameBoard").rows[this.m[a][0]].cells[this.m[a][1]].className+
" win"}}const y=()=>{t||(t=!0,document.getElementById("difficulty").disabled=!0,window.g=new p(Array.from(document.getElementById("difficulty").options).find(a=>a.selected).value))},v=a=>{const b=document.querySelector("link[rel*='icon']")||document.createElement("link");b.type="image/x-icon";b.rel="shortcut icon";b.href="favicon"+a+".ico"};(()=>{document.getElementById("start").addEventListener("click",y);for(var a=0;7>a;a++){var b=document.createElement("div");b.id="fc"+a;b.classList.add("floatingCircle");
document.getElementById("floatingCircles").appendChild(b)}for(a=0;6>a;a++){b=document.createElement("tr");document.getElementById("gameBoard").appendChild(b);for(let c=0;7>c;c++){const h=document.createElement("td");h.className="empty";h.id="td"+a+c;b.appendChild(h)}}})()})();
